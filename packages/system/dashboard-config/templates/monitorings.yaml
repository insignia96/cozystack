---
apiVersion: front.in-cloud.io/v1alpha1
kind: TableUriMapping
metadata:
  name: monitoring-detail
spec:
  id: "stock-namespace-/apps.cozystack.io/v1alpha1/monitorings"
  pathToNavigate: "/openapi-ui/{clusterName}/{namespace}/factory/monitoring-detail/~recordValue~"
  keysToParse:
    - metadata
    - name

---

apiVersion: front.in-cloud.io/v1alpha1
kind: CustomColumnsOverride
metadata:
  name: apps-cozystack-monitoring-detail
spec:
  id: "stock-namespace-/apps.cozystack.io/v1alpha1/monitorings"
  additionalPrinterColumns:
    - jsonPath: .metadata.name
      name: Name
      type: string
    - jsonPath: .metadata.namespace
      name: Namespace
      type: string
    - jsonPath: .status.version
      name: Version
      type: string

---
apiVersion: front.in-cloud.io/v1alpha1
kind: CustomColumnsOverride
metadata:
  name: factory-monitoring-detail-metrics-storages
spec:
  id: "factory-monitoring-detail-metrics-storages"
  additionalPrinterColumns:
    - jsonPath: .name
      name: Name
      type: string
    - jsonPath: .deduplicationInterval
      name: DeduplicationInterval
      type: string
    - jsonPath: .retentionPeriod
      name: RetentionPeriod
      type: string
    - jsonPath: .storage
      name: Storage
      type: string
---
apiVersion: front.in-cloud.io/v1alpha1
kind: CustomColumnsOverride
metadata:
  name: factory-monitoring-detail-logs-storages
spec:
  id: "factory-monitoring-detail-logs-storages"
  additionalPrinterColumns:
    - jsonPath: .name
      name: Name
      type: string
    - jsonPath: .retentionPeriod
      name: RetentionPeriod
      type: string
    - jsonPath: .storage
      name: Storage
      type: string
    - jsonPath: .storageClassName
      name: StorageClass
      type: string
---
apiVersion: front.in-cloud.io/v1alpha1
kind: CustomColumnsOverride
metadata:
  name: factory-monitoring-detail-status-conditions
spec:
  id: "factory-monitoring-detail-status-conditions"
  additionalPrinterColumns:
    - jsonPath: .type
      name: Type
      type: string
    - jsonPath: .status
      name: Status
      type: string
    - jsonPath: .lastTransitionTime
      name: LastTransitionTime
      type: date
    - jsonPath: .message
      name: Message
      type: string
  additionalPrinterColumnsUndefinedValues:
    - key: Message
      value: "-"
---
apiVersion: front.in-cloud.io/v1alpha1
kind: Factory
metadata:
  name: monitoring-detail
spec:
  key: monitoring-detail
  sidebarTags:
    - monitoring-sidebar
  withScrollableMainContentCard: true
  urlsToFetch:
    - "/api/clusters/{2}/k8s/apis/apps.cozystack.io/v1alpha1/namespaces/{3}/monitorings/{6}"
  data:
    - type: antdFlex
      data:
        id: header-flex
        align: center
        gap: 6
        style:
          marginBottom: 24px
      children:
        - type: antdText
          data:
            id: header-badge
            text: M
            title: Monitoring
            style:
              backgroundColor: "#009596"
              borderRadius: 20px
              color: "#fff"
              display: inline-block
              fontFamily: RedHatDisplay, Overpass, overpass, helvetica, arial, sans-serif
              fontSize: 20px
              fontWeight: 400
              lineHeight: 24px
              minWidth: 24
              padding: "0 9px"
              textAlign: center
              whiteSpace: nowrap
        - type: parsedText
          data:
            id: header-name
            text: "{reqs[0]['metadata','name']}"
            style:
              fontFamily: RedHatDisplay, Overpass, overpass, helvetica, arial, sans-serif
              fontSize: 20px
              lineHeight: 24px

    - type: antdTabs
      data:
        id: tabs-main
        defaultActiveKey: details
        items:
          - key: details
            label: Details
            children:
              - type: ContentCard
                data:
                  id: 2000
                  style:
                    marginBottom: 24px
                children:
                  - type: antdText
                    data:
                      id: 2001
                      text: Monitoring details
                      strong: true
                      style:
                        fontSize: 20
                        marginBottom: 12px
                  - type: Spacer
                    data: { id: 2001-sp, "$space": 16 }

                  - type: antdRow
                    data: { id: 2002, gutter: [48,12] }
                    children:
                      - type: antdCol
                        data: { id: 2003, span: 12 }
                        children:
                          - type: antdFlex
                            data: { id: 2004, vertical: true, gap: 24 }
                            children:
                              - type: antdFlex
                                data: { id: 2101, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21011, strong: true, text: Name }
                                  - type: parsedText
                                    data: { id: 21012, text: "{reqs[0]['metadata','name']}" }
                              - type: antdFlex
                                data: { id: 2102, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21021, strong: true, text: Namespace }
                                  - type: parsedText
                                    data: { id: 21022, text: "{reqs[0]['metadata','namespace']}" }
                              - type: antdFlex
                                data: { id: 2103, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21031, strong: true, text: Version }
                                  - type: parsedText
                                    data: { id: 21032, text: "{reqs[0]['status','version']}" }

                      - type: antdCol
                        data: { id: 2005, span: 12 }
                        children:
                          - type: antdFlex
                            data: { id: 2150, vertical: true, gap: 24 }
                            children:
                              # Grafana
                              - type: antdFlex
                                data: { id: 2151, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21511, strong: true, text: Grafana Host }
                                  - type: parsedText
                                    data: { id: 21512, text: "{reqs[0]['spec','grafana','host']}" }
                              # Alerta
                              - type: antdFlex
                                data: { id: 2161, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21611, strong: true, text: Alerta Storage }
                                  - type: parsedText
                                    data: { id: 21612, text: "{reqs[0]['spec','alerta','storage']}" }
                              - type: antdFlex
                                data: { id: 2162, vertical: true, gap: 4 }
                                children:
                                  - type: antdText
                                    data: { id: 21621, strong: true, text: Alerta StorageClass }
                                  - type: parsedText
                                    data: { id: 21622, text: "{reqs[0]['spec','alerta','storageClassName']}" }

                  - type: antdCol
                    data: { id: 2200, style: { marginTop: 32px, padding: 16px } }
                    children:
                      - type: antdText
                        data: { id: 22001, strong: true, style: { fontSize: 22, marginBottom: 32px }, text: Metrics Storages }
                      - type: EnrichedTable
                        data:
                          id: 22002
                          baseprefix: /openapi-ui
                          clusterNamePartOfUrl: "{2}"
                          fetchUrl: "/api/clusters/{2}/k8s/apis/apps.cozystack.io/v1alpha1/namespaces/{3}/monitorings/{6}"
                          customizationId: factory-monitoring-detail-metrics-storages
                          pathToItems: [spec, metricsStorages]
                          withoutControls: true

                  - type: antdCol
                    data: { id: 2300, style: { marginTop: 32px, padding: 16px } }
                    children:
                      - type: antdText
                        data: { id: 23001, strong: true, style: { fontSize: 22, marginBottom: 32px }, text: Logs Storages }
                      - type: EnrichedTable
                        data:
                          id: 23002
                          baseprefix: /openapi-ui
                          clusterNamePartOfUrl: "{2}"
                          fetchUrl: "/api/clusters/{2}/k8s/apis/apps.cozystack.io/v1alpha1/namespaces/{3}/monitorings/{6}"
                          customizationId: factory-monitoring-detail-logs-storages
                          pathToItems: [spec, logsStorages]
                          withoutControls: true

                  - type: antdCol
                    data: { id: 2400, style: { marginTop: 32px, padding: 16px } }
                    children:
                      - type: antdText
                        data: { id: 24001, strong: true, style: { fontSize: 22, marginBottom: 32px }, text: Conditions }
                      - type: EnrichedTable
                        data:
                          id: 24002
                          baseprefix: /openapi-ui
                          clusterNamePartOfUrl: "{2}"
                          fetchUrl: "/api/clusters/{2}/k8s/apis/apps.cozystack.io/v1alpha1/namespaces/{3}/monitorings/{6}"
                          customizationId: factory-monitoring-detail-status-conditions
                          pathToItems: [status, conditions]
                          withoutControls: true

          - key: yaml
            label: YAML
            children:
            - type: YamlEditorSingleton
              data:
                apiGroup: apps.cozystack.io
                apiVersion: v1alpha1
                cluster: '{2}'
                id: 999999999
                isNameSpaced: true
                prefillValuesRequestIndex: 0
                substractHeight: 400
                type: apis
                typeName: monitorings
